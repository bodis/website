<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI-Assisted QA Pipeline Visualization</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1600px;
            width: 100%;
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            padding: 40px;
        }

        h1 {
            text-align: center;
            color: #667eea;
            margin-bottom: 10px;
            font-size: 2.5em;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1em;
        }

        .controls {
            text-align: center;
            margin-bottom: 30px;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.1em;
            border-radius: 8px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            font-weight: 600;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        button:active {
            transform: translateY(0);
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .pipeline-wrapper {
            display: flex;
            gap: 20px;
            margin-top: 30px;
        }

        .time-elapsed {
            width: 120px;
            flex-shrink: 0;
        }

        .time-display {
            position: sticky;
            top: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        .time-label {
            font-size: 0.85em;
            opacity: 0.9;
            margin-bottom: 8px;
        }

        .time-value {
            font-size: 2.5em;
            font-weight: bold;
            font-family: 'Courier New', monospace;
        }

        .time-unit {
            font-size: 0.9em;
            opacity: 0.8;
            margin-top: 4px;
        }

        .pipeline {
            flex: 1;
            position: relative;
        }

        .stage {
            margin-bottom: 50px;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.6s, transform 0.6s;
        }

        .stage.active {
            opacity: 1;
            transform: translateY(0);
        }

        .stage-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        .stage-number {
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 15px;
            font-size: 1.3em;
            box-shadow: 0 4px 8px rgba(102, 126, 234, 0.3);
        }

        .stage-title {
            font-size: 1.6em;
            font-weight: 600;
            color: #333;
            flex: 1;
        }

        .stage-content {
            padding-left: 60px;
        }

        /* Progress overlay on cards */
        .card-wrapper {
            position: relative;
            overflow: hidden;
            border-radius: 10px;
        }

        .card-progress-overlay {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            background: linear-gradient(90deg, 
                rgba(102, 126, 234, 0.15) 0%, 
                rgba(118, 75, 162, 0.15) 100%);
            width: 0%;
            transition: width 0.1s linear;
            pointer-events: none;
            z-index: 1;
        }

        .card-content {
            position: relative;
            z-index: 2;
        }

        .language-columns {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .language-column {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 15px;
        }

        .language-header {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 12px;
            background: white;
            border-radius: 8px;
            margin-bottom: 15px;
            font-weight: 600;
            font-size: 1.1em;
        }

        .language-icon {
            font-size: 1.5em;
            margin-right: 10px;
        }

        .analyzer-box {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            margin-bottom: 12px;
            opacity: 0;
            transform: scale(0.95);
            transition: opacity 0.5s, transform 0.5s, border-color 0.3s, box-shadow 0.3s;
            position: relative;
            overflow: hidden;
        }

        .analyzer-box.active {
            opacity: 1;
            transform: scale(1);
        }

        .analyzer-box.completed {
            border-color: #28a745;
            box-shadow: 0 0 0 3px rgba(40, 167, 69, 0.2);
        }

        .analyzer-content {
            padding: 12px;
            position: relative;
            z-index: 2;
        }

        .analyzer-header {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }

        .analyzer-icon {
            width: 20px;
            height: 20px;
            margin-right: 8px;
        }

        .analyzer-name {
            font-weight: 600;
            color: #333;
            flex: 1;
            font-size: 0.95em;
        }

        .analyzer-status {
            font-size: 0.8em;
            padding: 3px 8px;
            border-radius: 10px;
            font-weight: 600;
        }

        .status-running {
            background: #fff3cd;
            color: #856404;
        }

        .status-completed {
            background: #d4edda;
            color: #155724;
        }

        .analyzer-output {
            font-size: 0.8em;
            color: #666;
            margin-top: 8px;
            display: none;
        }

        .analyzer-output.visible {
            display: block;
        }

        .finding {
            background: #f8f9fa;
            border-left: 3px solid #ffc107;
            padding: 6px 10px;
            margin: 4px 0;
            border-radius: 3px;
            font-size: 0.85em;
        }

        .finding.critical {
            border-left-color: #dc3545;
        }

        .finding.high {
            border-left-color: #fd7e14;
        }

        .finding.medium {
            border-left-color: #ffc107;
        }

        .sequential-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .ai-review-box {
            background: white;
            border: 2px solid #667eea;
            border-radius: 10px;
            opacity: 0;
            transform: translateX(-30px);
            transition: opacity 0.6s, transform 0.6s, box-shadow 0.3s;
            position: relative;
            overflow: hidden;
        }

        .ai-review-box.active {
            opacity: 1;
            transform: translateX(0);
        }

        .ai-review-box.completed {
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2);
        }

        .ai-review-content {
            padding: 15px;
            position: relative;
            z-index: 2;
        }

        .aggregation-box {
            background: linear-gradient(135deg, #fff5e6 0%, #ffe8cc 100%);
            border: 3px solid #ff9800;
            border-radius: 12px;
            padding: 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .aggregation-content {
            position: relative;
            z-index: 2;
        }

        .aggregation-result {
            opacity: 0;
            transition: opacity 0.5s;
        }

        .aggregation-result.visible {
            opacity: 1;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-top: 20px;
            opacity: 0;
            transform: scale(0.9);
            transition: opacity 0.5s, transform 0.5s;
        }

        .stats-grid.visible {
            opacity: 1;
            transform: scale(1);
        }

        .stat-box {
            background: white;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .stat-number {
            font-size: 2.2em;
            font-weight: bold;
            color: #667eea;
        }

        .stat-label {
            font-size: 0.85em;
            color: #666;
            margin-top: 5px;
        }

        .feedback-box {
            background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
            border: 3px solid #4caf50;
            border-radius: 12px;
            padding: 25px;
        }

        .feedback-item {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .feedback-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .severity-badge {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.85em;
            font-weight: 600;
            margin-right: 10px;
        }

        .severity-critical {
            background: #dc3545;
            color: white;
        }

        .severity-high {
            background: #fd7e14;
            color: white;
        }

        .severity-medium {
            background: #ffc107;
            color: #333;
        }

        .spinner {
            display: inline-block;
            width: 14px;
            height: 14px;
            border: 2px solid #f3f3f3;
            border-top: 2px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .completion-message {
            text-align: center;
            padding: 40px;
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            border-radius: 12px;
            margin-top: 30px;
            opacity: 0;
            transform: scale(0.9);
            transition: opacity 0.6s, transform 0.6s;
        }

        .completion-message.visible {
            opacity: 1;
            transform: scale(1);
        }

        .completion-message h2 {
            color: #155724;
            margin-bottom: 15px;
            font-size: 2em;
        }

        .completion-icon {
            font-size: 5em;
            margin-bottom: 20px;
            animation: bounce 0.6s ease;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-20px); }
            60% { transform: translateY(-10px); }
        }

        .code-snippet {
            background: #282c34;
            color: #abb2bf;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            margin: 10px 0;
            overflow-x: auto;
        }

        .keyword {
            color: #c678dd;
        }

        .string {
            color: #98c379;
        }

        .comment {
            color: #5c6370;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ AI-Assisted QA Pipeline</h1>
        <p class="subtitle">Watch how automated code review works in real-time</p>
        
        <div class="controls">
            <button id="startBtn" onclick="startPipeline()">Start Pipeline Demo</button>
            <button id="resetBtn" onclick="resetPipeline()" style="margin-left: 10px;" disabled>Reset</button>
        </div>

        <div class="pipeline-wrapper">
            <div class="time-elapsed">
                <div class="time-display">
                    <div class="time-label">Time Elapsed</div>
                    <div class="time-value" id="timeValue">0</div>
                    <div class="time-unit">seconds</div>
                </div>
            </div>

            <div class="pipeline" id="pipeline">
                <!-- Stage 0: PR Created -->
                <div class="stage" data-stage="0">
                    <div class="stage-header">
                        <div class="stage-number">1</div>
                        <div class="stage-title">üìù Pull Request Created</div>
                    </div>
                    <div class="stage-content">
                        <div class="code-snippet">
                            <span class="comment"># Developer pushes changes and creates PR</span><br>
                            <span class="keyword">git</span> push origin feature/payment-validation<br>
                            <span class="keyword">gh</span> pr create --title <span class="string">"Add payment validation"</span>
                        </div>
                        <p style="margin-top: 15px; color: #666;">
                            <strong>Detected Changes:</strong> authentication.py, PaymentService.java, payment.ts<br>
                            <strong>Languages:</strong> Python, Java, TypeScript<br>
                            <strong>Risk Level:</strong> <span style="color: #fd7e14; font-weight: 600;">HIGH</span> (includes security-sensitive code)
                        </p>
                    </div>
                </div>

                <!-- Stage 1: Static Analysis -->
                <div class="stage" data-stage="1">
                    <div class="stage-header">
                        <div class="stage-number">2</div>
                        <div class="stage-title">‚ö° Static Analysis (Parallel Execution)</div>
                    </div>
                    <div class="stage-content">
                        <div class="language-columns">
                            <!-- Python Column -->
                            <div class="language-column">
                                <div class="language-header">
                                    <span class="language-icon">üêç</span>
                                    Python
                                </div>
                                
                                <div class="card-wrapper analyzer-box" data-analyzer="ruff" data-duration="3500">
                                    <div class="card-progress-overlay"></div>
                                    <div class="card-content analyzer-content">
                                        <div class="analyzer-header">
                                            <div class="analyzer-name">Ruff</div>
                                            <div class="analyzer-status status-running">
                                                <span class="spinner"></span>
                                            </div>
                                        </div>
                                        <div class="analyzer-output">
                                            <div class="finding medium">Line 45: Unused import 'datetime'</div>
                                            <div class="finding medium">Line 78: Line too long (92 > 88)</div>
                                        </div>
                                    </div>
                                </div>

                                <div class="card-wrapper analyzer-box" data-analyzer="pylint" data-duration="4000">
                                    <div class="card-progress-overlay"></div>
                                    <div class="card-content analyzer-content">
                                        <div class="analyzer-header">
                                            <div class="analyzer-name">Pylint</div>
                                            <div class="analyzer-status status-running">
                                                <span class="spinner"></span>
                                            </div>
                                        </div>
                                        <div class="analyzer-output">
                                            <div class="finding high">Missing docstring in public method</div>
                                            <div class="finding medium">Variable 'x' doesn't conform to snake_case</div>
                                        </div>
                                    </div>
                                </div>

                                <div class="card-wrapper analyzer-box" data-analyzer="bandit" data-duration="3800">
                                    <div class="card-progress-overlay"></div>
                                    <div class="card-content analyzer-content">
                                        <div class="analyzer-header">
                                            <div class="analyzer-name">Bandit</div>
                                            <div class="analyzer-status status-running">
                                                <span class="spinner"></span>
                                            </div>
                                        </div>
                                        <div class="analyzer-output">
                                            <div class="finding critical">Line 123: Use of hardcoded password</div>
                                            <div class="finding high">Line 156: SQL query uses string formatting</div>
                                        </div>
                                    </div>
                                </div>

                                <div class="card-wrapper analyzer-box" data-analyzer="mypy" data-duration="4200">
                                    <div class="card-progress-overlay"></div>
                                    <div class="card-content analyzer-content">
                                        <div class="analyzer-header">
                                            <div class="analyzer-name">mypy</div>
                                            <div class="analyzer-status status-running">
                                                <span class="spinner"></span>
                                            </div>
                                        </div>
                                        <div class="analyzer-output">
                                            <div class="finding high">Argument type mismatch: expected 'int', got 'str'</div>
                                            <div class="finding medium">Missing return type annotation</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Java Column -->
                            <div class="language-column">
                                <div class="language-header">
                                    <span class="language-icon">‚òï</span>
                                    Java
                                </div>
                                
                                <div class="card-wrapper analyzer-box" data-analyzer="spotbugs" data-duration="5000">
                                    <div class="card-progress-overlay"></div>
                                    <div class="card-content analyzer-content">
                                        <div class="analyzer-header">
                                            <div class="analyzer-name">SpotBugs</div>
                                            <div class="analyzer-status status-running">
                                                <span class="spinner"></span>
                                            </div>
                                        </div>
                                        <div class="analyzer-output">
                                            <div class="finding high">Possible null pointer dereference in PaymentService</div>
                                            <div class="finding medium">Resource not closed: database connection</div>
                                        </div>
                                    </div>
                                </div>

                                <div class="card-wrapper analyzer-box" data-analyzer="pmd" data-duration="4500">
                                    <div class="card-progress-overlay"></div>
                                    <div class="card-content analyzer-content">
                                        <div class="analyzer-header">
                                            <div class="analyzer-name">PMD</div>
                                            <div class="analyzer-status status-running">
                                                <span class="spinner"></span>
                                            </div>
                                        </div>
                                        <div class="analyzer-output">
                                            <div class="finding medium">Avoid empty catch blocks</div>
                                            <div class="finding medium">Overly complex method (cyclomatic 18)</div>
                                        </div>
                                    </div>
                                </div>

                                <div class="card-wrapper analyzer-box" data-analyzer="checkstyle" data-duration="3200">
                                    <div class="card-progress-overlay"></div>
                                    <div class="card-content analyzer-content">
                                        <div class="analyzer-header">
                                            <div class="analyzer-name">Checkstyle</div>
                                            <div class="analyzer-status status-running">
                                                <span class="spinner"></span>
                                            </div>
                                        </div>
                                        <div class="analyzer-output">
                                            <div class="finding medium">Missing Javadoc comment</div>
                                            <div class="finding medium">Line exceeds 100 characters</div>
                                        </div>
                                    </div>
                                </div>

                                <div class="card-wrapper analyzer-box" data-analyzer="owasp" data-duration="6000">
                                    <div class="card-progress-overlay"></div>
                                    <div class="card-content analyzer-content">
                                        <div class="analyzer-header">
                                            <div class="analyzer-name">OWASP Check</div>
                                            <div class="analyzer-status status-running">
                                                <span class="spinner"></span>
                                            </div>
                                        </div>
                                        <div class="analyzer-output">
                                            <div class="finding critical">CVE-2024-1234 in jackson-databind 2.12.0</div>
                                            <div class="finding high">Outdated Spring Boot version with known vulnerabilities</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- TypeScript/JavaScript Column -->
                            <div class="language-column">
                                <div class="language-header">
                                    <span class="language-icon">üü¶</span>
                                    TypeScript/JS
                                </div>
                                
                                <div class="card-wrapper analyzer-box" data-analyzer="eslint" data-duration="3600">
                                    <div class="card-progress-overlay"></div>
                                    <div class="card-content analyzer-content">
                                        <div class="analyzer-header">
                                            <div class="analyzer-name">ESLint</div>
                                            <div class="analyzer-status status-running">
                                                <span class="spinner"></span>
                                            </div>
                                        </div>
                                        <div class="analyzer-output">
                                            <div class="finding high">Unexpected use of 'eval()'</div>
                                            <div class="finding medium">Missing semicolon</div>
                                            <div class="finding medium">Unused variable 'tempData'</div>
                                        </div>
                                    </div>
                                </div>

                                <div class="card-wrapper analyzer-box" data-analyzer="prettier" data-duration="2800">
                                    <div class="card-progress-overlay"></div>
                                    <div class="card-content analyzer-content">
                                        <div class="analyzer-header">
                                            <div class="analyzer-name">Prettier</div>
                                            <div class="analyzer-status status-running">
                                                <span class="spinner"></span>
                                            </div>
                                        </div>
                                        <div class="analyzer-output">
                                            <div class="finding medium">Inconsistent indentation (2 vs 4 spaces)</div>
                                        </div>
                                    </div>
                                </div>

                                <div class="card-wrapper analyzer-box" data-analyzer="tsc" data-duration="4800">
                                    <div class="card-progress-overlay"></div>
                                    <div class="card-content analyzer-content">
                                        <div class="analyzer-header">
                                            <div class="analyzer-name">TypeScript</div>
                                            <div class="analyzer-status status-running">
                                                <span class="spinner"></span>
                                            </div>
                                        </div>
                                        <div class="analyzer-output">
                                            <div class="finding high">Type 'string | null' not assignable to 'string'</div>
                                            <div class="finding medium">Implicit 'any' type in function parameter</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Stage 2: AI Review -->
                <div class="stage" data-stage="2">
                    <div class="stage-header">
                        <div class="stage-number">3</div>
                        <div class="stage-title">ü§ñ AI Semantic Analysis (Sequential)</div>
                    </div>
                    <div class="stage-content">
                        <div class="sequential-container">
                            <div class="card-wrapper ai-review-box" data-review="security" data-duration="5000">
                                <div class="card-progress-overlay"></div>
                                <div class="card-content ai-review-content">
                                    <div class="analyzer-header">
                                        <div class="analyzer-icon">üõ°Ô∏è</div>
                                        <div class="analyzer-name">Security Review</div>
                                        <div class="analyzer-status status-running">
                                            <span class="spinner"></span>
                                        </div>
                                    </div>
                                    <div class="analyzer-output">
                                        <div class="finding critical">
                                            Authentication token stored in plaintext in session. Use encrypted storage or server-side sessions.
                                        </div>
                                        <div class="finding high">
                                            Payment amount calculation doesn't validate decimal precision - can lead to rounding errors.
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="card-wrapper ai-review-box" data-review="architecture" data-duration="5000">
                                <div class="card-progress-overlay"></div>
                                <div class="card-content ai-review-content">
                                    <div class="analyzer-header">
                                        <div class="analyzer-icon">üèóÔ∏è</div>
                                        <div class="analyzer-name">Architecture Review</div>
                                        <div class="analyzer-status status-running">
                                            <span class="spinner"></span>
                                        </div>
                                    </div>
                                    <div class="analyzer-output">
                                        <div class="finding high">
                                            Payment service directly accesses database - should use repository pattern for testability.
                                        </div>
                                        <div class="finding medium">
                                            Mixing business logic with HTTP handling - consider separating concerns.
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="card-wrapper ai-review-box" data-review="quality" data-duration="5000">
                                <div class="card-progress-overlay"></div>
                                <div class="card-content ai-review-content">
                                    <div class="analyzer-header">
                                        <div class="analyzer-icon">‚ú®</div>
                                        <div class="analyzer-name">Code Quality Review</div>
                                        <div class="analyzer-status status-running">
                                            <span class="spinner"></span>
                                        </div>
                                    </div>
                                    <div class="analyzer-output">
                                        <div class="finding medium">
                                            Function complexity score: 15 (threshold: 10) - consider breaking into smaller functions.
                                        </div>
                                        <div class="finding medium">
                                            Duplicate validation logic in payment.py and refund.py - extract to shared utility.
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="card-wrapper ai-review-box" data-review="performance" data-duration="5000">
                                <div class="card-progress-overlay"></div>
                                <div class="card-content ai-review-content">
                                    <div class="analyzer-header">
                                        <div class="analyzer-icon">‚ö°</div>
                                        <div class="analyzer-name">Performance Review</div>
                                        <div class="analyzer-status status-running">
                                            <span class="spinner"></span>
                                        </div>
                                    </div>
                                    <div class="analyzer-output">
                                        <div class="finding high">
                                            N+1 query detected: Loading payment records in loop. Use batch fetch or join.
                                        </div>
                                        <div class="finding medium">
                                            Missing index on 'user_id' column - queries will be slow with large datasets.
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="card-wrapper ai-review-box" data-review="testing" data-duration="5000">
                                <div class="card-progress-overlay"></div>
                                <div class="card-content ai-review-content">
                                    <div class="analyzer-header">
                                        <div class="analyzer-icon">üß™</div>
                                        <div class="analyzer-name">Testing Review</div>
                                        <div class="analyzer-status status-running">
                                            <span class="spinner"></span>
                                        </div>
                                    </div>
                                    <div class="analyzer-output">
                                        <div class="finding high">
                                            No tests for negative payment amounts - critical edge case missing.
                                        </div>
                                        <div class="finding medium">
                                            Missing test for concurrent payment processing - race condition risk.
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Stage 3: Aggregation -->
                <div class="stage" data-stage="3">
                    <div class="stage-header">
                        <div class="stage-number">4</div>
                        <div class="stage-title">üìä Result Aggregation & Deduplication</div>
                    </div>
                    <div class="stage-content">
                        <div class="card-wrapper aggregation-box" data-duration="5000">
                            <div class="card-progress-overlay"></div>
                            <div class="card-content aggregation-content">
                                <h3>üîÑ Combining Results...</h3>
                                <p style="margin: 15px 0; color: #666;">
                                    Merging findings from 11 static analyzers and 5 AI review aspects<br>
                                    Deduplicating similar issues ‚Ä¢ Categorizing by severity ‚Ä¢ Calculating statistics
                                </p>
                                <div class="stats-grid aggregation-result">
                                    <div class="stat-box">
                                        <div class="stat-number">4</div>
                                        <div class="stat-label">üî¥ Critical</div>
                                    </div>
                                    <div class="stat-box">
                                        <div class="stat-number">9</div>
                                        <div class="stat-label">üü† High</div>
                                    </div>
                                    <div class="stat-box">
                                        <div class="stat-number">13</div>
                                        <div class="stat-label">üü° Medium</div>
                                    </div>
                                    <div class="stat-box">
                                        <div class="stat-number">5</div>
                                        <div class="stat-label">üîµ Low</div>
                                    </div>
                                </div>
                                <p class="aggregation-result" style="margin-top: 20px; color: #d32f2f; font-weight: 600;">
                                    ‚ö†Ô∏è BLOCKING: Critical issues detected - PR cannot be merged
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Stage 4: Feedback -->
                <div class="stage" data-stage="4">
                    <div class="stage-header">
                        <div class="stage-number">5</div>
                        <div class="stage-title">üí¨ GitHub Feedback Posted</div>
                    </div>
                    <div class="stage-content">
                        <div class="feedback-box">
                            <h3>üìù PR Comments Generated</h3>
                            
                            <div class="feedback-item">
                                <div class="feedback-header">
                                    <span class="severity-badge severity-critical">üî¥ CRITICAL</span>
                                    <strong>authentication.py:123</strong>
                                </div>
                                <p><strong>Security:</strong> Hardcoded password detected</p>
                                <p style="margin-top: 8px; color: #666; font-size: 0.9em;">
                                    Never store credentials in code. Use environment variables or a secrets manager.
                                </p>
                                <p style="margin-top: 8px; color: #999; font-size: 0.85em;">
                                    <em>Found by: Bandit, Security Review (AI)</em>
                                </p>
                            </div>

                            <div class="feedback-item">
                                <div class="feedback-header">
                                    <span class="severity-badge severity-critical">üî¥ CRITICAL</span>
                                    <strong>PaymentService.java:45</strong>
                                </div>
                                <p><strong>Security:</strong> CVE-2024-1234 in jackson-databind dependency</p>
                                <p style="margin-top: 8px; color: #666; font-size: 0.9em;">
                                    Critical vulnerability in jackson-databind 2.12.0. Upgrade to 2.15.3 or later immediately.
                                </p>
                                <p style="margin-top: 8px; color: #999; font-size: 0.85em;">
                                    <em>Found by: OWASP Dependency Check</em>
                                </p>
                            </div>

                            <div class="feedback-item">
                                <div class="feedback-header">
                                    <span class="severity-badge severity-high">üü† HIGH</span>
                                    <strong>payment.ts:67</strong>
                                </div>
                                <p><strong>Performance:</strong> N+1 query detected</p>
                                <p style="margin-top: 8px; color: #666; font-size: 0.9em;">
                                    Loading payment records in loop. Use batch fetch or JOIN for better performance.
                                </p>
                                <p style="margin-top: 8px; color: #999; font-size: 0.85em;">
                                    <em>Found by: Performance Review (AI)</em>
                                </p>
                            </div>

                            <p style="margin-top: 25px; padding: 15px; background: #fff3cd; border-radius: 8px; color: #856404;">
                                <strong>üìå Summary:</strong> Review complete in ~120 seconds. 
                                Found 31 total issues (4 critical, 9 high, 13 medium, 5 low). 
                                PR blocked due to critical security issues. Please fix and push updates.
                            </p>

                            <p style="margin-top: 15px; text-align: center; color: #666; font-size: 0.9em;">
                                ‚úÖ Status check: <strong style="color: #d32f2f;">FAILED</strong> ‚Ä¢ 
                                Cost: <strong>$0.05</strong> ‚Ä¢ 
                                Next: Fix issues and push changes for re-review
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="completion-message" id="completionMessage">
            <div class="completion-icon">‚úÖ</div>
            <h2>Pipeline Complete!</h2>
            <p style="font-size: 1.2em;">Developer receives immediate, actionable feedback in ~45 seconds</p>
            <p style="margin-top: 15px; color: #666; font-size: 1.1em;">
                Total cost: $0.05 ‚Ä¢ Issues found: 31 ‚Ä¢ Time saved: Hours of manual review
            </p>
        </div>
    </div>

    <script>
        let currentStage = -1;
        let isRunning = false;
        let timeElapsed = 0;
        let timeInterval = null;
        let cardProgressIntervals = [];

        const stages = [
            { duration: 3000 },   // PR Created - 3s
            { duration: 8000 },   // Static Analysis - 8s (slowest tool finishes)
            { duration: 25000 },  // AI Review - 25s (5 sequential reviews at 5s each)
            { duration: 5000 },   // Aggregation - 5s
            { duration: 3000 }    // Feedback - 3s
        ];

        function startPipeline() {
            if (isRunning) return;
            
            isRunning = true;
            currentStage = -1;
            timeElapsed = 0;
            
            document.getElementById('startBtn').disabled = true;
            document.getElementById('resetBtn').disabled = true;
            
            // Start time counter
            timeInterval = setInterval(() => {
                timeElapsed++;
                document.getElementById('timeValue').textContent = timeElapsed;
            }, 1000);
            
            nextStage();
        }

        function nextStage() {
            currentStage++;
            
            if (currentStage >= stages.length) {
                completePipeline();
                return;
            }

            // Show current stage
            const stageElement = document.querySelector(`[data-stage="${currentStage}"]`);
            if (stageElement) {
                stageElement.classList.add('active');
                stageElement.scrollIntoView({ behavior: 'smooth', block: 'start', inline: 'nearest' });
            }

            // Handle stage-specific animations
            if (currentStage === 1) {
                animateStaticAnalysis();
            } else if (currentStage === 2) {
                animateAIReview();
            } else if (currentStage === 3) {
                animateAggregation();
            }

            // Move to next stage
            setTimeout(() => {
                nextStage();
            }, stages[currentStage].duration);
        }

        function animateCardProgress(card, duration) {
            const overlay = card.querySelector('.card-progress-overlay');
            if (!overlay) return;
            
            const startTime = Date.now();
            const interval = setInterval(() => {
                const elapsed = Date.now() - startTime;
                const progress = Math.min((elapsed / duration) * 100, 100);
                overlay.style.width = progress + '%';
                
                if (progress >= 100) {
                    clearInterval(interval);
                }
            }, 50);
            
            cardProgressIntervals.push(interval);
        }

        function animateStaticAnalysis() {
            const analyzerBoxes = document.querySelectorAll('[data-analyzer]');
            
            analyzerBoxes.forEach((box, index) => {
                setTimeout(() => {
                    box.classList.add('active');
                    const duration = parseInt(box.dataset.duration) || 3000;
                    
                    // Start progress bar animation
                    animateCardProgress(box, duration);
                    
                    // Complete after duration
                    setTimeout(() => {
                        const status = box.querySelector('.analyzer-status');
                        status.innerHTML = '‚úÖ';
                        status.classList.remove('status-running');
                        status.classList.add('status-completed');
                        
                        box.classList.add('completed');
                        box.querySelector('.analyzer-output').classList.add('visible');
                    }, duration);
                }, index * 300);
            });
        }

        function animateAIReview() {
            const reviewBoxes = document.querySelectorAll('[data-review]');
            let cumulativeDelay = 0;
            
            reviewBoxes.forEach((box, index) => {
                setTimeout(() => {
                    box.classList.add('active');
                    box.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    
                    const duration = parseInt(box.dataset.duration) || 10000;
                    
                    // Start progress bar animation
                    animateCardProgress(box, duration);
                    
                    // Complete after duration
                    setTimeout(() => {
                        const status = box.querySelector('.analyzer-status');
                        status.innerHTML = '‚úÖ';
                        status.classList.remove('status-running');
                        status.classList.add('status-completed');
                        
                        box.classList.add('completed');
                        box.querySelector('.analyzer-output').classList.add('visible');
                    }, duration);
                }, cumulativeDelay);
                
                cumulativeDelay += parseInt(box.dataset.duration) || 10000;
            });
        }

        function animateAggregation() {
            const aggregationBox = document.querySelector('.aggregation-box');
            const duration = parseInt(aggregationBox.dataset.duration) || 5000;
            
            animateCardProgress(aggregationBox, duration);
            
            // Show results when progress completes
            setTimeout(() => {
                const results = aggregationBox.querySelectorAll('.aggregation-result');
                results.forEach(result => {
                    result.classList.add('visible');
                });
            }, duration);
        }

        function completePipeline() {
            clearInterval(timeInterval);
            document.getElementById('completionMessage').classList.add('visible');
            document.getElementById('resetBtn').disabled = false;
            isRunning = false;
            
            // Clear all progress intervals
            cardProgressIntervals.forEach(interval => clearInterval(interval));
            cardProgressIntervals = [];
        }

        function resetPipeline() {
            // Clear time interval
            if (timeInterval) {
                clearInterval(timeInterval);
                timeInterval = null;
            }
            
            // Clear all progress intervals
            cardProgressIntervals.forEach(interval => clearInterval(interval));
            cardProgressIntervals = [];
            
            // Reset all states
            currentStage = -1;
            isRunning = false;
            timeElapsed = 0;
            document.getElementById('timeValue').textContent = '0';
            
            // Reset buttons
            document.getElementById('startBtn').disabled = false;
            document.getElementById('resetBtn').disabled = true;
            
            // Reset stages
            document.querySelectorAll('.stage').forEach(stage => {
                stage.classList.remove('active');
            });
            
            // Reset progress overlays
            document.querySelectorAll('.card-progress-overlay').forEach(overlay => {
                overlay.style.width = '0%';
            });
            
            // Reset analyzers
            document.querySelectorAll('.analyzer-box').forEach(box => {
                box.classList.remove('active', 'completed');
                box.querySelector('.analyzer-output').classList.remove('visible');
                const status = box.querySelector('.analyzer-status');
                status.innerHTML = '<span class="spinner"></span>';
                status.classList.add('status-running');
                status.classList.remove('status-completed');
            });
            
            // Reset AI reviews
            document.querySelectorAll('.ai-review-box').forEach(box => {
                box.classList.remove('active', 'completed');
                box.querySelector('.analyzer-output').classList.remove('visible');
                const status = box.querySelector('.analyzer-status');
                status.innerHTML = '<span class="spinner"></span>';
                status.classList.add('status-running');
                status.classList.remove('status-completed');
            });
            
            // Reset aggregation results
            document.querySelectorAll('.aggregation-result').forEach(result => {
                result.classList.remove('visible');
            });
            
            // Reset completion message
            document.getElementById('completionMessage').classList.remove('visible');
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
    </script>
</body>
</html>
